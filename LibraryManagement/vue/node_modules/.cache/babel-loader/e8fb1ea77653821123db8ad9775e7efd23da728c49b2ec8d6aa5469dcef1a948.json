{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport router from \"@/router\";\nimport request from \"@/utils/request\";\n//   import { load } from \"mime\";\nimport Cookies from 'js-cookie';\nexport default {\n  name: \"AdminList\",\n  data() {\n    return {\n      admin: Cookies.get('admin') ? JSON.parse(Cookies.get('admin')) : {},\n      tableData: [],\n      total: 0,\n      dialogFormVisible: false,\n      form: {},\n      params: {\n        pageNum: 1,\n        pagesize: 10,\n        name: \"\",\n        phone: \"\",\n        email: \"\"\n      },\n      index: false,\n      rules: {\n        newPass: [{\n          required: true,\n          message: \"请输入新密码\",\n          trigger: \"blur\"\n        }, {\n          min: 3,\n          max: 10,\n          message: \"密码长度不合规 「3 - 10」\",\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  created() {\n    this.load();\n  },\n  methods: {\n    load() {\n      request.get(\"/admin/page\", {\n        params: this.params\n      }).then(res => {\n        if (res.code = \"200\") {\n          this.tableData = res.data.list;\n          this.total = res.data.total;\n        }\n      });\n    },\n    loadAsc() {\n      request.get(\"/admin/pageAsc\", {\n        params: this.params\n      }).then(res => {\n        if (res.code = \"200\") {\n          this.tableData = res.data.list;\n          this.total = res.data.total;\n        }\n      });\n    },\n    del(id) {\n      request.delete(\"/admin/delete/\" + id).then(res => {\n        if (res.code === \"200\") {\n          this.$notify.success(\"删除成功\");\n          this.load();\n        } else {\n          this.$notify.error(\"删除失败\");\n        }\n      });\n    },\n    reset() {\n      this.params = {\n        pageNum: 1,\n        pagesize: 10,\n        name: \"\",\n        phone: \"\",\n        email: \"\"\n      };\n      this.load();\n    },\n    handelCurrentChange(pNum) {\n      // 点击分页按钮 触发分页\n      console.log(pNum);\n      this.params.pageNum = pNum;\n      this.load();\n    },\n    switchSort(index) {\n      if (this.index === true) {\n        this.loadAsc();\n        console.log(index);\n      } else {\n        this.load();\n        console.log(index);\n      }\n    },\n    handleChangePass(row) {\n      this.form = JSON.parse(JSON.stringify(row));\n      this.dialogFormVisible = true;\n    },\n    savePass() {\n      this.$refs[\"formRef\"].validate(valid => {\n        if (valid) {\n          request.put('/admin/changePass', this.form).then(res => {\n            if (res.code === '200') {\n              this.$notify.success('修改成功');\n              //  当前修改的管理员 id == 当前登陆的管理员 id 则修改成功之后需要重新登陆 \n              if (this.form.id === this.admin.id) {\n                Cookies.remove('admin');\n                this.$router.push('/login');\n              } else {\n                // 刷新界面 重新请求\n                this.load();\n                // 关闭弹窗\n                this.dialogFormVisible = false;\n              }\n            } else {\n              this.$notify.error('修改失败');\n            }\n          });\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["router","request","Cookies","name","data","admin","get","JSON","parse","tableData","total","dialogFormVisible","form","params","pageNum","pagesize","phone","email","index","rules","newPass","required","message","trigger","min","max","created","load","methods","then","res","code","list","loadAsc","del","id","delete","$notify","success","error","reset","handelCurrentChange","pNum","console","log","switchSort","handleChangePass","row","stringify","savePass","$refs","validate","valid","put","remove","$router","push"],"sources":["src/views/admin/List.vue"],"sourcesContent":["<template>\n<div style=\"padding: 35px\">\n    <!-- 搜索表单 -->\n    <div style=\"margin-bottom: 20px\">\n        <!-- 检索输入框 -->\n        <el-input style=\"width: 140px\" placeholder=\"请输入用户名\" v-model=\"params.username\"></el-input>\n        <el-input style=\"margin-left: 5px; width: 160px\" placeholder=\"请输入联系方式\" v-model=\"params.phone\"></el-input>\n        <el-input style=\"margin-left: 5px; width: 160px\" placeholder=\"请输入电子邮箱\" v-model=\"params.email\"></el-input>\n\n        <el-button @click=\"load\" style=\"margin-left: 5px\" type=\"primary\"><i class=\"el-icon-search\"></i><span>搜索</span></el-button>\n        <el-button @click=\"reset\" style=\"margin-left: 5px\" type=\"warning\"><i class=\"el-icon-refresh\"></i><span>重置</span></el-button>\n\n        <el-button style=\"float: right; margin-right: 13px\" @click=\"$router.push('/addAdmin')\" type=\"danger\"><i class=\"el-icon-refresh\"></i><span>添加用户</span></el-button>\n        <el-button @click=\"(index = !index), switchSort(index)\" style=\"float: right; margin-right: 0px\" type=\"primary\"><i class=\"el-icon-loading\"></i><span>{{ index ? \"倒序\" : \"正序\" }}</span></el-button>\n    </div>\n\n    <el-table :data=\"tableData\" stripe>\n        <el-table-column prop=\"id\" width=\"90\" label=\"编号\"></el-table-column>\n        <el-table-column prop=\"username\" width=\"100\" label=\"用户名\"></el-table-column>\n        <el-table-column prop=\"phone\" width=\"180\" label=\"联系方式\"></el-table-column>\n        <el-table-column prop=\"email\" width=\"220\" label=\"EMAIL\"></el-table-column>\n        <el-table-column prop=\"createtime\" width=\"150\" label=\"创建时间\"></el-table-column>\n        <el-table-column prop=\"updatetime\" width=\"150\" label=\"更新时间\"></el-table-column>\n\n        <el-table-column label=\"状态\">\n            <template v-slot=\"scope\">\n                <el-switch v-model=\"scope.row\" active-color=\"#13ce66\" inactive-color=\"#ff4949\"></el-switch>\n            </template>\n        </el-table-column>\n\n        <el-table-column label=\"操作\">\n            <template v-slot=\"scope\">\n                <el-button style=\"float: ;\" @click=\"$router.push('/editAdmin?id=' + scope.row.id)\" type=\"primary\" size=\"mini\">编辑</el-button>\n                <el-popconfirm style=\"margin-left: 10px; float: ;\" title=\"您确定删除这行数据嘛？\" @confirm=\"del(scope.row.id)\">\n                    <el-button type=\"danger\" size=\"mini\" slot=\"reference\">删除</el-button>\n                </el-popconfirm>\n                <el-button style=\"float: ;margin-left: 10px; \" @click=\"handleChangePass(scope.row)\" type=\"warning\" size=\"mini\">修改密码</el-button>\n\n            </template>\n        </el-table-column>\n    </el-table>\n\n    <!-- 分页 -->\n    <div style=\"margin-top: 10px\">\n        <div class=\"block\">\n            <el-pagination current-page=\"params.pageNum\" page-size=\"params.pageSize\" layout=\"prev, pager, next\" @current-change=\"handelCurrentChange\" :total=\"total\">\n            </el-pagination>\n        </div>\n    </div>\n\n    <!-- 修改密码弹窗 -->\n    <el-dialog title=\"修改密码\" :visible.sync=\"dialogFormVisible\" width=\"30%\">\n        <el-form :model=\"form\" label-width=\"100px\" ref=\"formRef\" :rules=\"rules\">\n            <el-form-item label=\"新密码\" prop=\"newPass\">\n                <el-input v-model=\"form.newPass\" autocomplete=\"off\" show-password></el-input>\n            </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n            <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n            <el-button type=\"primary\" @click=\"savePass\">确 定</el-button>\n        </div>\n    </el-dialog>\n\n</div>\n</template>\n\n<script>\nimport router from \"@/router\";\nimport request from \"@/utils/request\";\n//   import { load } from \"mime\";\nimport Cookies from 'js-cookie'\n\nexport default {\n    name: \"AdminList\",\n\n    data() {\n        return {\n            admin: Cookies.get('admin') ? JSON.parse(Cookies.get('admin')) : {},\n            tableData: [],\n            total: 0,\n            dialogFormVisible: false,\n            form: {},\n            params: {\n                pageNum: 1,\n                pagesize: 10,\n                name: \"\",\n                phone: \"\",\n                email: \"\",\n            },\n            index: false,\n            rules: {\n                newPass: [{\n                    required: true,\n                    message: \"请输入新密码\",\n                    trigger: \"blur\"\n                }, {\n                    min: 3,\n                    max: 10,\n                    message: \"密码长度不合规 「3 - 10」\",\n                    trigger: 'blur'\n                }],\n\n            }\n        };\n    },\n    created() {\n        this.load();\n    },\n    methods: {\n        load() {\n            request\n                .get(\"/admin/page\", {\n                    params: this.params,\n                })\n                .then((res) => {\n                    if ((res.code = \"200\")) {\n                        this.tableData = res.data.list;\n                        this.total = res.data.total;\n                    }\n                });\n        },\n        loadAsc() {\n            request\n                .get(\"/admin/pageAsc\", {\n                    params: this.params,\n                })\n                .then((res) => {\n                    if ((res.code = \"200\")) {\n                        this.tableData = res.data.list;\n                        this.total = res.data.total;\n                    }\n                });\n        },\n        del(id) {\n            request.delete(\"/admin/delete/\" + id).then((res) => {\n                if (res.code === \"200\") {\n                    this.$notify.success(\"删除成功\");\n                    this.load();\n                } else {\n                    this.$notify.error(\"删除失败\");\n                }\n            });\n        },\n        reset() {\n            this.params = {\n                pageNum: 1,\n                pagesize: 10,\n                name: \"\",\n                phone: \"\",\n                email: \"\"\n            };\n            this.load();\n        },\n        handelCurrentChange(pNum) {\n            // 点击分页按钮 触发分页\n            console.log(pNum);\n            this.params.pageNum = pNum;\n            this.load();\n        },\n        switchSort(index) {\n            if (this.index === true) {\n                this.loadAsc();\n                console.log(index);\n            } else {\n                this.load();\n                console.log(index);\n            }\n        },\n        handleChangePass(row) {\n            this.form = JSON.parse(JSON.stringify(row))\n            this.dialogFormVisible = true;\n        },\n        savePass() {\n            this.$refs[\"formRef\"].validate((valid) => {\n                if (valid) {\n                    request.put('/admin/changePass', this.form).then(res => {\n                        if (res.code === '200') {\n                            this.$notify.success('修改成功');\n                            //  当前修改的管理员 id == 当前登陆的管理员 id 则修改成功之后需要重新登陆 \n                            if (this.form.id === this.admin.id) {\n                                Cookies.remove('admin')\n                                this.$router.push('/login')\n                            } else {\n                                // 刷新界面 重新请求\n                                this.load()\n                                // 关闭弹窗\n                                this.dialogFormVisible = false;\n                            }\n                        } else {\n                            this.$notify.error('修改失败')\n                        }\n                    })\n\n                }\n            })\n\n        },\n    },\n};\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}